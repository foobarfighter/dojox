<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
	<title></title>
	<script type="text/javascript" src="../../../dojo/dojo.js"
	    djConfig="isDebug: true"></script>
	<script type="text/javascript">
		dojo.require("doh.runner");
		dojo.require("dojox.rails");
		
		var parsedNodes;	
		
		doh.register("dojox.rails.tests.Parser", [
			{
				name: "parse",
				runTest: function(t) {
					t.is(2, dojox.rails.parse().length);
				}
			},
			{
				name: "delegate",
				setUp: function() {
					parsedNodes = dojox.rails.parse();
				},
				runTest: function(t) {
					dojox.rails.delegate(parsedNodes);
					
					var remotes = dojox.rails.manager.findByType("remote");
					t.is(1, remotes.length);
					dojo.forEach(remotes, function(obj) {
						t.is(dojox.rails.RemoteForm.prototype.constructor, obj.constructor);
					});
					
					var fieldObservers = dojox.rails.manager.findByType("observe_field");
					t.is(1, fieldObservers.length);
					dojo.forEach(fieldObservers, function(obj) {
						t.is(dojox.rails.FieldObserver.prototype.constructor, obj.constructor);
					});
				}
			}
		]);
		
		dojo.addOnLoad(function() {
			doh.run();
		});
	</script>
</head>
<body>

<form id="form-remote" method="post" data-js-type="remote">
</form>

<script type="application/json" data-js-type="observe_field">
// <![CDATA[
	{ "url": "/some/url" }
// ]]>
</script>


</body>
</html>